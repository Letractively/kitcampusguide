<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
 	xmlns:c="http://java.sun.com/jsp/jstl/core"
  	xmlns:cc="http://java.sun.com/jsf/composite"
  	xmlns:f="http://java.sun.com/jsf/core"
  	xmlns:hl="http://java.sun.com/jsf/composite/headline"
  	xmlns:ma="http://java.sun.com/jsf/composite/map"
  	xmlns:sb="http://java.sun.com/jsf/composite/sidebar"
  	xmlns:o="http://openfaces.org/">
<head><title>campusguide</title></head><body>
<cc:interface>
	<cc:attribute name="model" required="true" />
</cc:interface>
<cc:implementation>
	
 	<h:outputScript target="head" library="javax.faces" name="jsf.js" />
 	<h:outputStylesheet taget="head" library="campusguide" name="campusguide.css"/>
 	<div id="headline">
		<h:form id="search">
		<h:outputText id="current-poi" value="#{cc.attrs.model.currentPOI}" class="hidden">
				<f:converter converterId="poiConverter" />
		</h:outputText>
		<o:suggestionField id="search-field" value="#{cc.attrs.model.hlm.search}" 
			promptText="#{msgs.search_field}" valueChangeListener="#{cc.attrs.model.searchChanged}"
			size="50" autoComplete="true"
       	 	suggestionDelay="200" suggestionMinChars="2"
        	suggestionMode="substring"
        	listStyle="z-index:9999;">
		<o:dropDownItems value="#{constantData.allPOIName}"/>
 		<f:ajax render="current-poi" execute="search-field" event="valueChange"/>
		</o:suggestionField>
		<h:commandButton id="search-button" value="#{msgs.search_button}"
			onclick="showPOI()" class="search-button"> 
		<f:ajax render="@this"/>
		</h:commandButton>
		</h:form>
	</div>
 	<table id="map-sidebar" cellspacing="0" cellpadding="0" class="cgtable" >
	<tbody>			
	<tr>
		<td style="width:423px;">				
		<h:form id="map-form" class="hidden">
			<h:outputText id="all-poi" value="#{constantData.categories}" class="hidden">
				<f:converter converterId="poiCategoryListConverter" />
			</h:outputText>
		</h:form>			
			<script type="text/javascript" src="resources/openlayers/OpenLayers.js" />
			<div id="map"></div> 
			<script type="text/javascript" src="resources/campusguide/campusguide.js" />
			<script type="text/javascript" src="resources/campusguide/util.js" />
			<script type="text/javascript">
				setClientID('#{cc.clientId}');
				drawmap();
			</script>
		</td>
		<td style="width:141px;">
			<div id="sidebar">
				<h:form id="route">
					<h:outputText id="current-route" value="#{cc.attrs.model.currentRoute}" 
						class="hidden">
						<f:converter converterId="routeConverter" />
					</h:outputText>
					<o:suggestionField id="from-field" promptText="#{msgs.route_from}" 
						valueChangeListener="#{cc.attrs.model.fromChanged}" autoComplete="true"
       					suggestionDelay="200" suggestionMinChars="1" suggestionMode="substring"
        				listStyle="z-index:9999;" style="width:95%;">
						<o:dropDownItems value="#{constantData.allPOIName}" />
 						<f:ajax render="current-route" execute="from-field" event="valueChange"/>
					</o:suggestionField>
					<br />
					<o:suggestionField id="to-field" promptText="#{msgs.route_to}" 
						valueChangeListener="#{cc.attrs.model.toChanged}"
						autoComplete="true" suggestionDelay="200"
        				suggestionMinChars="2" suggestionMode="substring"
       					listStyle="z-index:9999;" style="width:95%;">
						<o:dropDownItems value="#{constantData.allPOIName}" />
 						<f:ajax render="current-route" execute="to-field" event="valueChange"/>
					</o:suggestionField>
					<h:commandButton id="route" value="#{msgs.route_button}" onclick="route();">
						<f:ajax render="@none" />
					</h:commandButton>
					<h:commandButton id="hide-route" value="#{msgs.route_hide}" 
						onclick="hideRoute();" action="#{cc.attrs.model.removeRoute}">
						<f:ajax render="@none" />
					</h:commandButton>
				</h:form>
				<script type="text/javascript" src="resources/campusguide/sidebar.js" />
				<div id="sidebar-suggestions">
				</div>
				<o:foldingPanel id="poi-filter" caption="#{msgs.poi_filter}" expanded="true"
					foldingDirection="up" contentStyle="line-height: 2; vertical-align: bottom;" 
					style="width:50%;z-index:9999; position:relative;">
					<o:forEach items="#{constantData.categoriesName}" var="category" 
						varStatus="status">
						<o:selectBooleanCheckbox value="true" 
							onchange="showMarkers(this.value, '#{category}')"/>
						<h:outputText value="#{category}" /> <br />
					</o:forEach>				
				</o:foldingPanel>
			</div> 
		</td>
	</tr>
	</tbody>
	</table> 
</cc:implementation>
</body></html>