<?xml version="1.0" encoding="UTF-8"?>
<ui:component xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:cc="http://java.sun.com/jsf/composite">
	<cc:interface>
		<!-- Attributes -->
		<cc:attribute name="map"
			type="edu.kit.cm.kitcampusguide.standardtypes.Map" required="true" />
		<cc:attribute name="building" required="true"
			type="edu.kit.cm.kitcampusguide.standardtypes.Building" />
		<cc:attribute name="mapLocator" required="true"
			type="edu.kit.cm.kitcampusguide.presentationlayer.view.MapLocator" />
		<cc:attribute name="POIs" required="true"/>
		<cc:attribute name="highlightedPOIID"
			type="java.lang.String" required="true" />
		<cc:attribute name="markerFrom"
			type="edu.kit.cm.kitcampusguide.standardtypes.MapPosition"
			required="true" />
		<cc:attribute name="markerTo"
			type="edu.kit.cm.kitcampusguide.standardtypes.MapPosition"
			required="true" />
		<cc:attribute name="route" type="edu.kit.cm.kitcampusguide.standardtypes.Route" 
		required="true"/>
		<cc:attribute name="buildingPOI"
			type="edu.kit.cm.kitcampusguide.standardtypes.POI" required="true" />
		<cc:attribute name="buildingPOIList" required="true" />
		<cc:attribute name="changedProperties" required="true" />
		<!-- EditableValueHolders -->
		<cc:editableValueHolder name="valueChangeListener"
			targets="form:mapLocator form:markerTo form:markerFrom form:highlightedPOIID" />
		<!-- TODO: POIListener action source must be defined -->
	</cc:interface>
	<cc:implementation>
		<h:outputScript target="head" library="mapcomponent"
			name="mapcomponent.js" />
			<script type="text/javascript" src="resources/mapcomponent/openlayers/lib/OpenLayers.js" />
		<!-- This outputScript didn't always work in my system for some reason. Maybe it will work
on the final system? -->
<!--				<h:outputScript target="head" library="mapcomponent"-->
<!--					name="openlayers.js" />-->
		<h:outputStylesheet target="head" library="mapcomponent"
			name="map.css" />
		<h:outputScript target="head" library="javax.faces" name="jsf.js" />
		<div id="#{cc.clientId}:map" class="map"></div>
		<h:form id="form" class="hidden">
			<h:inputHidden id="mapLocator" value="#{cc.attrs.mapLocator}">
				<f:converter converterId="mapLocatorConverter" />
			</h:inputHidden>
			<h:outputText id="map" value="#{cc.attrs.map}">
				<f:converter converterId="mapConverter" />
			</h:outputText>
			<h:outputText id="building" value="#{cc.attrs.building}" class="hidden">
				<f:converter converterId="buildingConverter" />
			</h:outputText>
			<h:outputText id="POIs" value="#{cc.attrs.POIs}" class="hidden">
				<f:converter converterId="poiListConverter" />
			</h:outputText>
			<h:inputHidden id="highlightedPOIID" value="#{cc.attrs.highlightedPOIID}" class="hidden">
			<!-- use the default converter for the poi id -->
			</h:inputHidden>
			<h:inputHidden id="markerFrom" value="#{cc.attrs.markerFrom}" class="hidden">
				<f:converter converterId="mapPositionConverter" />
			</h:inputHidden>
			<h:inputHidden id="markerTo" value="#{cc.attrs.markerTo}" class="hidden">
				<f:converter converterId="mapPositionConverter" />
			</h:inputHidden>
			<h:outputText id="route" value="#{cc.attrs.route}" class="hidden">
				<f:converter converterId="routeConverter" />
			</h:outputText>
			<h:outputText id="buildingPOI" value="#{cc.attrs.buildingPOI}" class="hidden">
				<f:converter converterId="poiConverter" />
			</h:outputText>
			<h:outputText id="buildingPOIList" value="#{cc.attrs.buildingPOIList}" class="hidden">
				<f:converter converterId="poiListConverter" />
			</h:outputText>
			<h:outputText id="changedProperties" value="#{cc.attrs.changedProperties}" class="hidden">
				<f:converter converterId="changedPropertiesConverter" />
			</h:outputText>
		</h:form>
		<script type="text/javascript">
			new KITCampusMap('#{cc.clientId}');
		</script>
	</cc:implementation>
</ui:component>
