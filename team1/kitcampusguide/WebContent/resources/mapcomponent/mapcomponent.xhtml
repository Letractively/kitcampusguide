<?xml version="1.0" encoding="UTF-8"?>
<ui:component xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:cc="http://java.sun.com/jsf/composite"
	xmlns:tr="http://myurl.de">
	
	<cc:interface>
		<!-- Attributes -->
		<cc:attribute name="mapModel"
			type="edu.kit.cm.kitcampusguide.presentationlayer.viewmodel.MapModel" required="true" />
		<cc:attribute name="additionalRenderIDs" default="" />
		<!-- EditableValueHolders -->
		<cc:editableValueHolder name="valueChangeListener"
			targets="form:outputField" />
	</cc:interface>
	<cc:implementation>
		<!-- This script is used for HTML encoding/decoding	-->
		<h:outputScript target="head" library="mapcomponent" name="encoder.js" />
		<h:outputScript target="head" library="mapcomponent" name="mapcomponent.js" />
		<h:outputScript target="head" library="mapcomponent" name="kitcampushelper.js" />
		<!-- //TODO: If possible, check if this include can be done via an output script -->
		<script type="text/javascript" src="resources/mapcomponent/openlayers/lib/OpenLayers.js" />
<!--				<h:outputScript target="head" library="mapcomponent"-->
<!--					name="openlayers.js" />-->
		<h:outputStylesheet target="head" library="mapcomponent"
			name="map.css" />
		<h:outputScript target="head" library="javax.faces" name="jsf.js" />
		<div id="#{cc.clientId}:map" class="map"></div>
		<h:form id="form" class="hidden">
			<h:outputText id="mapModel" value="#{cc.attrs.mapModel}" class="hidden">
				<f:converter converterId="mapModelConverter" />
			</h:outputText>
			<h:outputText id="additionalRenderIDs" class="hidden"
				value="#{cc.attrs.additionalRenderIDs}" />
			<h:inputHidden id="outputField" class="hidden">
				<f:converter converterId="outputConverter" />
			</h:inputHidden>
		</h:form>
		<div class="hidden">
			<h:outputText class="hidden"
				value="#{tr:translate('showBuildingMap')}"
				id="showBuildingMapLabel" />
			<h:outputText class="hidden"
			value="#{tr:translate('showPOIsInBuilding')}"
			id="showPOIsInBuildingLabel" />
			<h:outputText class="hidden"
			value="#{tr:translate('setRouteTo')}"
			id="setRouteToLabel" />
			<h:outputText class="hidden"
			value="#{tr:translate('setRouteFrom')}"
			id="setRouteFromLabel" />
		</div>
		<script type="text/javascript">
		function load() {
				new KITCampusMap('#{cc.clientId}');
		}
	
		// Add map as startup listener
		if (document.addEventListener)
			document.addEventListener("DOMContentLoaded", load, false);
		else {
			document.onreadystatechange = function() {
				if (document.readyState == "interactive"
						|| document.readyState == "complete")
					load();
			}
		}
		</script>
	</cc:implementation>
</ui:component>
